# 설문지 매핑 프로그램 - 사용 설명서

## 📋 목차
1. [프로그램 소개](#프로그램-소개)
2. [설치 방법](#설치-방법)
3. [주요 기능](#주요-기능)
4. [사용 방법](#사용-방법)
5. [단축키](#단축키)
6. [팁과 노하우](#팁과-노하우)
7. [문제 해결](#문제-해결)

---

## 🎯 프로그램 소개

설문지 매핑 프로그램은 설문조사 데이터의 문자열 응답을 숫자로 변환하는 작업을 **쉽고 빠르게** 수행할 수 있도록 도와주는 도구입니다.

### 주요 개선 사항
- ✨ **현대적인 UI**: 직관적이고 보기 좋은 인터페이스
- 🖱️ **드래그 앤 드롭**: 파일을 끌어다 놓기만 하면 로드
- 👀 **실시간 미리보기**: 변환 결과를 즉시 확인
- ⚡ **빠른 매핑**: 자동 매핑 기능으로 시간 절약
- 💾 **템플릿 저장**: 매핑 설정을 저장하고 재사용
- 🔄 **되돌리기**: 실수해도 원본으로 쉽게 복구

---

## 💿 설치 방법

### 1. 필수 라이브러리 설치

```bash
pip install pandas openpyxl tkinterdnd2
```

### 2. 프로그램 실행

```bash
python 설문지매핑_테스트_고급버전.py
```

### 참고사항
- **TkinterDnD2 설치 실패 시**: 드래그 앤 드롭 기능 없이 실행됩니다 (파일 찾아보기 버튼 사용 가능)
- Python 3.7 이상 권장

---

## 🌟 주요 기능

### 1. 파일 업로드
- **찾아보기 버튼**: 클릭해서 파일 선택
- **드래그 앤 드롭**: 파일을 프로그램 창에 끌어다 놓기
- 지원 형식: `.xlsx`, `.xls`

### 2. 변수 관리
- **검색 기능**: 🔍 검색창에서 변수명으로 빠르게 찾기
- **다중 선택**:
  - `Ctrl + 클릭`: 개별 선택
  - `Shift + 클릭`: 범위 선택
- **필터링**:
  - "전체 선택": 모든 변수 선택
  - "선택 해제": 선택 취소
  - "매핑 안된 것만": 아직 매핑하지 않은 변수만 선택

### 3. 매핑 방식

#### 📝 일반 매핑
1. 변수 선택
2. "🚀 선택한 변수 매핑 시작" 클릭
3. 각 선택지마다 숫자 입력
   - 숫자 입력: 해당 숫자로 매핑
   - `p` 입력: 패스 (원본 유지)

#### ⚡ 빠른 매핑
- "⚡ 빠른 매핑" 클릭
- 선택지가 이미 숫자면 자동으로 매핑
- 예: "1" → 1, "2" → 2, "3" → 3

### 4. 데이터 미리보기
- **📊 데이터 미리보기** 탭: 현재 데이터 상태 확인 (최대 100행)
- **🔄 매핑 정보** 탭: 어떻게 매핑되었는지 확인
- **📝 작업 로그** 탭: 작업 이력 확인

### 5. 통계 정보
- 총 변수 개수
- 매핑 완료된 변수 개수
- 총 데이터 행 수
- 진행률 바

### 6. 저장 기능
- **💾 저장**: 매핑된 데이터를 엑셀로 저장
  - 결과 파일: `매핑완료_날짜시간.xlsx`
  - 매핑 정보 파일: `매핑정보_날짜시간.xlsx`

### 7. 템플릿 기능
- **📄 템플릿 저장**: 현재 매핑 설정을 JSON 파일로 저장
- **📂 템플릿 불러오기**: 이전에 저장한 매핑 설정 불러오기
- 동일한 설문지를 반복 처리할 때 유용!

### 8. 되돌리기
- **🔄 되돌리기**: 모든 매핑을 취소하고 원본으로 복구

---

## 📖 사용 방법

### 기본 워크플로우

```
1. 파일 로드
   ↓
2. 변수 선택
   ↓
3. 매핑 실행
   ↓
4. 미리보기로 확인
   ↓
5. 저장
```

### 자세한 단계별 가이드

#### Step 1: 파일 로드
1. **방법 A**: "찾아보기" 버튼 클릭 → 파일 선택
2. **방법 B**: 엑셀 파일을 프로그램 창에 드래그 앤 드롭

✅ 성공하면 변수 목록이 자동으로 표시됩니다.

#### Step 2: 변수 선택
1. 왼쪽 변수 목록에서 매핑할 변수 선택
   - 단일 선택: 클릭
   - 다중 선택: `Ctrl` + 클릭
   - 범위 선택: `Shift` + 클릭
2. 또는 "매핑 안된 것만" 버튼으로 자동 선택

#### Step 3: 매핑 실행

**일반 매핑**
1. "🚀 선택한 변수 매핑 시작" 클릭
2. 팝업창이 나타나면:
   - 원본 값을 확인
   - 매핑할 숫자 입력
   - Enter 또는 "✓ 확인" 클릭
3. 모든 선택지에 대해 반복

**빠른 매핑**
1. "⚡ 빠른 매핑" 클릭
2. 자동으로 숫자 형태의 선택지가 매핑됨

#### Step 4: 결과 확인
1. "📊 데이터 미리보기" 탭에서 변환된 데이터 확인
2. "🔄 매핑 정보" 탭에서 매핑 내역 확인
3. 잘못된 경우 "🔄 되돌리기" 클릭

#### Step 5: 저장
1. "💾 저장" 버튼 클릭
2. 저장 위치와 파일명 지정
3. 두 개의 파일이 생성됨:
   - 매핑된 데이터 파일
   - 매핑 정보 파일 (검토용)

---

## ⌨️ 단축키

| 단축키 | 기능 |
|--------|------|
| `Ctrl + O` | 파일 열기 |
| `Ctrl + S` | 저장 |
| `Ctrl + Z` | 되돌리기 |
| `Ctrl + F` | 검색창 포커스 |
| `F5` | 미리보기 새로고침 |

---

## 💡 팁과 노하우

### 1. 효율적인 변수 선택
- 비슷한 형태의 변수들을 함께 선택하면 매핑이 공유됩니다
- 예: "만족도1", "만족도2", "만족도3"을 함께 선택하면 "매우 만족"을 한 번만 입력하면 됨

### 2. 템플릿 활용
- 같은 설문지를 여러 번 처리할 때 첫 번째 매핑을 템플릿으로 저장
- 이후 템플릿을 불러와서 바로 사용

### 3. 매핑 정보 파일 활용
- 저장 시 생성되는 "매핑정보.xlsx" 파일로 매핑이 올바른지 확인
- 설문지와 대조하여 검토

### 4. 패스(p) 기능 활용
- 숫자로 변환할 필요 없는 값(예: 주관식 응답)은 `p` 입력
- 원본 값이 그대로 유지됨

### 5. 빠른 매핑 활용
- 이미 숫자로 코딩된 설문지(1, 2, 3, 4, 5)는 빠른 매핑 사용
- 시간을 크게 절약할 수 있습니다

### 6. 작업 로그 확인
- "📝 작업 로그" 탭에서 모든 작업 내역 확인 가능
- 문제 발생 시 로그를 확인하여 원인 파악

---

## 🔧 문제 해결

### Q1: 프로그램이 실행되지 않아요
**A**: 필수 라이브러리 설치 확인
```bash
pip install pandas openpyxl tkinterdnd2
```

### Q2: 드래그 앤 드롭이 안 돼요
**A**: TkinterDnD2 설치 실패한 경우입니다. "찾아보기" 버튼을 사용하세요.

### Q3: 파일을 열 수 없다고 나와요
**A**:
- 파일이 다른 프로그램에서 열려있는지 확인
- 파일 형식이 `.xlsx` 또는 `.xls`인지 확인
- 파일 경로에 한글이나 특수문자가 있는지 확인

### Q4: 매핑이 잘못됐어요
**A**:
- "🔄 되돌리기" 버튼으로 원본으로 복구
- 다시 매핑 진행

### Q5: 중복 선택 문항(|)이 인식 안 돼요
**A**:
- 현재 프로그램은 `|`를 구분자로 사용
- 다른 구분자를 사용하는 경우 코드 수정 필요

### Q6: 숫자가 이미 있는데 변환이 안 돼요
**A**:
- "⚡ 빠른 매핑" 기능 사용
- 또는 일반 매핑에서 동일한 숫자 입력

### Q7: 저장 위치를 모르겠어요
**A**:
- 저장 후 "저장 위치를 여시겠습니까?" 메시지에서 "예" 클릭
- 폴더가 자동으로 열립니다

---

## 📞 지원

문제가 해결되지 않거나 추가 기능이 필요하면:
1. 작업 로그 탭의 내용을 캡처
2. 오류 메시지 스크린샷
3. 담당자에게 문의

---

## 📝 버전 정보

**버전**: 2.0 (고급 사용자 친화 버전)
**작성일**: 2025

### 주요 변경사항
- 전면 UI 개선
- 드래그 앤 드롭 지원
- 실시간 미리보기
- 템플릿 기능 추가
- 빠른 매핑 기능
- 진행률 표시
- 작업 로그 추가

---

## 🎓 부록: 예제

### 예제 1: 리커트 척도 설문

**원본 데이터**
```
만족도1: 매우 만족
만족도2: 만족
만족도3: 보통
```

**매핑 과정**
1. 세 변수 모두 선택
2. 매핑 시작
   - "매우 만족" → 5 입력
   - "만족" → 4 입력
   - "보통" → 3 입력
   - "불만족" → 2 입력
   - "매우 불만족" → 1 입력

**결과**
```
만족도1: 5
만족도2: 4
만족도3: 3
```

### 예제 2: 중복 선택 문항

**원본 데이터**
```
선호음식: 한식|중식|일식
```

**매핑 과정**
- "한식" → 1
- "중식" → 2
- "일식" → 3
- "양식" → 4

**결과**
```
선호음식: 1,2,3
```

### 예제 3: 빠른 매핑

**원본 데이터** (이미 숫자로 코딩됨)
```
Q1: 1
Q2: 2
Q3: 3
```

**작업**
1. 변수 선택
2. "⚡ 빠른 매핑" 클릭
3. 자동 완료!

---

## 🎉 마무리

이 프로그램을 사용하면 설문지 매핑 작업을 **빠르고 정확하게** 완료할 수 있습니다.

**핵심 장점**:
- ⏱️ **시간 절약**: 수작업 대비 10배 이상 빠름
- ✅ **정확성**: 매핑 정보 파일로 검증 가능
- 🔄 **재사용성**: 템플릿으로 반복 작업 간소화
- 👀 **직관성**: 보기 쉬운 UI로 누구나 쉽게 사용

**사용 전 체크리스트**:
- [ ] 필수 라이브러리 설치 완료
- [ ] 엑셀 파일 준비
- [ ] 설문지 원본 확인 (매핑 검토용)

**사용 후 체크리스트**:
- [ ] 매핑 정보 파일로 검토
- [ ] 결과 파일 백업
- [ ] 자주 쓰는 매핑은 템플릿 저장

행복한 데이터 분석 되세요! 🚀
